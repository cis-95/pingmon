# üõ∞Ô∏è PingMon

**PingMon** ‡πÄ‡∏õ‡πá‡∏ô Shell Script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ (ping) ‡∏Ç‡∏≠‡∏á VM/IP ‡∏´‡∏•‡∏≤‡∏¢ ‡πÜ ‡∏ï‡∏±‡∏ß**  
‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Log ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° IP ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤ Log (Retention) ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î (‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 7 ‡∏ß‡∏±‡∏ô)

> ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô `crontab` ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Monitor ‡∏Å‡∏≤‡∏£ Ping ‡∏ñ‡∏∂‡∏á‡∏Å‡∏±‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á VM ‡πÉ‡∏ô Layer 2

---

## ‚ú® Features
- ‚úÖ ‡∏≠‡πà‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ IP ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏•‡∏∞ 1 IP, ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå `#`)
- ‚úÖ Ping ‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏ô `crontab`
- ‚úÖ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Log ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° **IP / ‡∏ß‡∏±‡∏ô**
- ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö Log ‡πÅ‡∏ö‡∏ö Retention (‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 7 ‡∏ß‡∏±‡∏ô ‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÉ‡∏ô `config.env`)
- ‚úÖ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Log ‡πÅ‡∏ö‡∏ö **CSV-friendly**  

## üì¶ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

### 1. ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î repo
```
git clone https://github.com/cis-95/pingmon.git
```
```
cd pingmon
```

### 2. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á script ‡πÑ‡∏õ‡∏ó‡∏µ‡πà /usr/local/bin
```
sudo install -m 755 pingmon.sh /usr/local/bin/pingmon
```

### 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå config + log
```
sudo mkdir -p /etc/pingmon /var/log/pingmon
```

### 4. ‡∏ß‡∏≤‡∏á config ‡πÅ‡∏•‡∏∞ targets
```
sudo cp config.env /etc/pingmon/config.env
```
```
sudo cp targets.txt /etc/pingmon/targets.txt
```

### 5. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå config.env ‡πÅ‡∏•‡∏∞ target.txt
```
sudo vi /etc/pingmon/config.env
```
```
sudo vi /etc/pingmon/targets.txt
```

### 6. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Run
```
pingmon -c /etc/pingmon/config.env
```

### 7. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Cron/Timer
```
sudo crontab -e
```
‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á cron ‡∏ó‡∏∏‡∏Å 5 ‡∏ô‡∏≤‡∏ó‡∏µ:
```
*/5 * * * * /usr/local/bin/pingmon -c /etc/pingmon/config.env >/dev/null 2>&1
```
---

## üìÇ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Log
/var/log/pingmon/
‚îú‚îÄ 10.10.1.10/
‚îÇ   ‚îî‚îÄ 2025-09-01.log
‚îú‚îÄ 10.10.1.11/
‚îÇ   ‚îî‚îÄ 2025-09-01.log
‚îî‚îÄ 10.10.2.20/
‚îî‚îÄ 2025-09-01.log

---

## üìä ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Log

‡∏î‡∏∂‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î 5 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î ‡∏Ç‡∏≠‡∏á IP `10.10.1.10`:

```bash
tail -n 5 /var/log/pingmon/10.10.1.10/$(date +%F).log
```
‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:
```
2025-09-01T13:37:00+07:00,up,0,0.72,0
2025-09-01T13:42:00+07:00,down,100,,1
2025-09-01T13:47:00+07:00,up,0,0.65,0
2025-09-01T13:52:00+07:00,up,0,0.69,0
2025-09-01T13:57:00+07:00,up,0,0.71,0
```
‡∏ü‡∏¥‡∏•‡∏î‡πå‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
```
timestamp,status,loss_percent,avg_rtt_ms,exit_code
```

‚Ä¢	status = up / down

‚Ä¢	loss_percent = % packet loss

‚Ä¢	avg_rtt_ms = ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÄ‡∏ß‡∏•‡∏≤ ping (ms)

‚Ä¢	exit_code = ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà ping ‡∏Ñ‡∏∑‡∏ô‡∏Å‡∏•‡∏±‡∏ö (0 = ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à, ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ = ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß)